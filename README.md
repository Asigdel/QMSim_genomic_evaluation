# QMSim Genomic Evaluation

**Maintainer**: *Rostam Abdollahi-Arpanahi*

**Date**: May 3, 2020

---

QMSim is a widely used program for simulation a broad range of genetic architectures and population structures in livestock. Download the manual of program by click on [QMSim_documentation](http://animalbiosciences.uoguelph.ca/~msargol/qmsim/QMSim_documentation.pdf)

The version of program here is a little bit different than the version available in [QMSim home page](http://animalbiosciences.uoguelph.ca/~msargol/qmsim/). So, I would suggest you use the attached version available in the current repository.

In order to run QMSim, we need an Input parameter file. The various parameters for the simulation should be specified in the parameter file. The input parameter file must be in ASCII format.

In addition to mandatory Input parameter file, for the genomic evaluation, A system executable external file (Exe_EBV.R) is provided here. This R-script is doing the Genomic evaluation using BayesB method. In case you are interested in other Statistical method for genomic evaluation, you should modify the Rscript at your own risk.

Excellent! Now lets run the program:

## 1. Download and Unzip the QMSim file using the following command

```
git clone https://github.com/Rostamabd/QMSim_genomic_evaluation.git
unzip QMSim.zip
```

if the QMSim file is not in executable format, run the following command

```
chmod 775 QMSim
```

## 2. Convert Exe_EBV.R file to executable format

```
chmod 775 Exe_EBV.R
```

The Exe_EBV.R file takes the genotype data generated by QMSim in the r_toy_par folder (p1_mrk_001.txt) and phenotype data in the current directory (data.tmp) as the input file.

In this example, for speeding up the computation, we only use the last 2000 individuals in data.tmp file for genomic evaluation. if you are willing to run the genomic evaluation using all data, you should comment out the if {} block. 

## 3. Run QMSim

```
./QMSim toy_par.prm
```

You might get some errors, in most cases, those are related to setting the directory for running Exe_EBV.R. 

## 4. Output files

The default output folder name is r_”parameter file name”, but you can change its name and directory in the output_folder option in input parameter file.

The most important output for computing the prediction accuracy is the last column of data.tmp file which is located is the same directory as input parameter file. Inputed_BV column is GEBVs that are computed in each generation. The GEBV for the last generation is missing in the data.tmp, but it can be retrieved from my_bv.txt file.

## Contact Information

Please send your comments and suggestions to rostam7474 at gmail dot com





